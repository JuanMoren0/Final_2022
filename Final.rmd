---
title: "Covid91 vaccine study Final2022"
author: "Juan Moreno"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="final_Data.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
options(digits = 1)
```

# Introduction

A new  preventative vaccine (covid91) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

```{r, include='FALSE'}
# Not included to make things look neater  
Males<- filter(FinalData, sex== "M"); 
Females <- filter(FinalData, sex== "F")
lgbtq <- filter(FinalData, LGBTQ=="gay")
druggies <- filter(FinalData, DrugUser=="yes")
```


## Males


### Descriptive Results


#### Graphical Descriptive Results

```{r}
ddm <- Males %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicCm <- ggplot(ddm,aes(x=infected,y=count,fill= treatment))
basicCm + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCCm <- ggplot(ddm,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCCm + geom_bar(stat="identity", position = "dodge")
```

After creating a group made up of purely males we take   the data and create a bar chart so there can be a   visual of he data of the vaccine effectiveness when   used on males.    



#### Numerical Descriptive Results


```{r}
table1m <- xtabs(~infected + treatment, data=Males)
rowPerc(table1m)
colPerc(table1m)
```

Taking the group purely made of males once more, we now   have created a data sheet, that show the same as the   visual above, showing that the vaccine is working for   males.  

###Inferential Results

```{r}
chisq.test(table1m)
chisqtestGC(table1m)
malefisher<- fisher.test(table1m)
malefisher
```

Here we have taken the male group for one last time and     have ran the Fisher's Exact test. This shows that the     p-value proves that those who have taken the placebo     are more likely to catch Covid.    

### Efficacy

```{r}
#used to create efficacy for males
efficacym <- ((2.092161/(1+2.092161)*100))

malefisherlow <- (malefisher$conf.int[1])

malefisherhigh<- (malefisher$conf.int[2])

efficacymalelow <- (malefisherlow/(1+malefisherlow)*100)

efficacymalehigh <- (malefisherhigh/(1+malefisherhigh)*100)
```

Here we have the confidence interval of 95%  from `r efficacymalelow` to `r efficacymalehigh`. With the efficacy for males being `r efficacym`%


### Conclusion and Recommendation




## Females

### Descriptive Results

#### Graphical Descriptive Results

```{r}
ddf <- Females %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicCf <- ggplot(ddf,aes(x=infected,y=count,fill= treatment))
basicCf + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCCf <- ggplot(ddf,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCCf + geom_bar(stat="identity", position = "dodge")
```


#### Numerical Descriptive Results

```{r}
table1f <- xtabs(~infected + treatment, data=Females)
rowPerc(table1f)
colPerc(table1f)
```

### Inferential Results

```{r}
chisq.test(table1f)
chisqtestGC(table1f)
fisher.test(table1f)
```


### Efficacy 



## LGBTQ


### Descriptive Results

#### Graphical Descriptive Results

```{r}
ddQ <- lgbtq %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicCQ <- ggplot(ddQ,aes(x=infected,y=count,fill= treatment))
basicCQ + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCCQ <- ggplot(ddQ,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCCQ + geom_bar(stat="identity", position = "dodge")
```


#### Numerical Descriptive Results

```{r}
table1Q <- xtabs(~infected + treatment, data=lgbtq)
rowPerc(table1Q)
colPerc(table1Q)
```


###Inferential Results

```{r}
chisq.test(table1Q)
chisqtestGC(table1Q)
fisher.test(table1Q)
```


### Efficacy 





## Druggies





### Descriptive Results

#### Graphical Descriptive Results

```{r}
ddd <- druggies %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicCd <- ggplot(ddd,aes(x=infected,y=count,fill= treatment))
basicCd + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCCd <- ggplot(ddm,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCCd + geom_bar(stat="identity", position = "dodge")
```


#### Numerical Descriptive Results

```{r}
table1d <- xtabs(~infected + treatment, data=druggies)
rowPerc(table1d)
colPerc(table1d)
```


###Inferential Results

```{r}
chisq.test(table1d)
chisqtestGC(table1d)
fisher.test(table1d)
```


### Efficacy 


